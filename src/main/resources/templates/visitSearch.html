<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Search Visit - EyeManage</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.css}" />
<link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />

<script type="text/javascript" th:src="@{/js/jquery3.min.js}"></script>
</head>
<body>

	<div id="wrapper" class="toggled">
		<!-- Navbar Fragment -->
		<div th:replace="layout :: navbar"></div>

		<!-- Contact Us Fragment -->
		<div th:replace="layout :: contactUs"></div>

		<!-- Sidebar Fragment -->
		<div th:replace="layout :: sidebar"></div>

		<!-- Page Content -->
		<div id="page-content-wrapper">
			<div class="container-fluid">
				<div class="row">
					<div class="col-lg-12">
						<div class="page-header">
							<h2>Visit Search</h2>
							<hr />
						</div>
						<form action="#" method="post" th:object="${visitPojo}"
							th:action="@{/dashboard/visitSearch}" class="form-horizontal">
							<div class="form-group">
								<label class="control-label col-sm-2"> Search By : </label>
								<div class="col-sm-2">
									<select name="filterByList" id="visitSearchDrop"
										th:field="*{searchFilter}" class="form-control">
										<option value="">Select a Filter</option>
										<option th:value="name">Name</option>
										<option th:value="date">Visit Date</option>
									</select>
								</div>

								<div class="col-sm-3 input-group" id="nameTextDiv">
									<input type="text" class="form-control" id="visitSearchValue"
										th:field="*{searchText}" placeholder="Enter a Text" />
									<div class="input-group-btn">
										<button class="btn btn-default" type="submit">
											<i class="glyphicon glyphicon-search"></i>
										</button>
									</div>
								</div>
								<div class="col-sm-3" id="dateFromDiv">
									<input type="date" class="form-control"
										th:field="*{searchDateFrom}" placeholder="Select From Date"
										th:id="searchDateFrom" />
								</div>
								<div class="col-sm-3 input-group" id="dateToDiv">
									<input type="date" class="form-control"
										th:field="*{searchDateTo}" placeholder="Select To Date"
										th:id="searchDateTo" />
									<div class="input-group-btn">
										<button class="btn btn-default" type="submit">
											<i class="glyphicon glyphicon-search"></i>
										</button>
									</div>
								</div>
								<span class="col-sm-3" id="msg"></span>
							</div>
							<div class="table-responsive"
								th:if="${not #lists.isEmpty(visitList)}">
								<table class="table table-striped" id="visitTable">
									<thead>
										<tr>
											<th>Visit Id</th>
											<th>Patient Id</th>
											<th>Patient Name</th>
											<th>Visit Date</th>
											<th>Fees</th>
											<th>Follow Up</th>
											<th colspan="1"></th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="visit : ${visitList}" class="clickable-row"
											th:id="'tr' + ${visit.visitId}">
											<td th:text="${visit.visitId}"></td>
											<td th:text="${visit.patient.patientId}"></td>
											<td
												th:text="${visit.patient.firstName} + ' ' + ${visit.patient.lastName}"></td>
											<td th:text="${#dates.format(visit.visitDate,'dd-MMM-yyyy')}"></td>
											<td th:text="${visit.fees}"></td>
											<td th:text="${visit.followUp}"></td>
											<td>
												<button type="button" class="btn" data-toggle="modal"
													th:attr="data-target='#viewModalVisit' + ${visit.visitId}">View</button>

												<!-- Visit View Modal -->
												<div th:attr="id='viewModalVisit' + ${visit.visitId}"
													class="modal fade" role="dialog">
													<div class="modal-dialog modal-lg">

														<!-- Modal content-->
														<div class="modal-content">
															<div class="modal-header">
																<button type="button" class="close" data-dismiss="modal">&times;</button>
																<h4 class="modal-title">Visit Details</h4>
															</div>
															<div class="modal-body">

																<ul class="nav nav-tabs">
																	<li class="active"
																		th:id="'li_glass_' + ${visit.visitId}"><a
																		data-toggle="tab"
																		th:href="'#glass_' + ${visit.visitId}">Glass
																			Prescription</a></li>
																	<li th:id="'li_findings_' + ${visit.visitId}"><a
																		data-toggle="tab"
																		th:href="'#findings_' + ${visit.visitId}">Findings</a></li>
																	<li th:id="'li_drug_' + ${visit.visitId}"><a
																		data-toggle="tab"
																		th:href="'#drug_' + ${visit.visitId}">Drug
																			Prescription</a></li>
																	<li th:id="'li_ascan_' + ${visit.visitId}"><a
																		data-toggle="tab"
																		th:href="'#ascan_' + ${visit.visitId}">A-Scan
																			Report</a></li>
																	<li th:id="'li_discharge_' + ${visit.visitId}"><a
																		data-toggle="tab"
																		th:href="'#discharge_' + ${visit.visitId}">Discharge
																			Summary</a></li>
																</ul>

																<div class="tab-content">
																	<!-- Glass Prescription Tab -->
																	<div th:id="'glass_' + ${visit.visitId}"
																		class="tab-pane fade in active">
																		<div class="form-group">
																			<div class="table-responsive col-sm-10">
																				<table class="table table-striped table-bordered">
																					<thead>
																						<tr>
																							<th colspan="2"></th>
																							<th colspan="4" align="center">Right Eye</th>
																							<th colspan="4" align="center">Left Eye</th>
																						</tr>
																						<tr>
																							<th colspan="2"></th>
																							<th colspan="1">Sph</th>
																							<th colspan="1">Cyl</th>
																							<th colspan="1">Axis</th>
																							<th colspan="1">V.A.</th>
																							<th colspan="1">Sph</th>
																							<th colspan="1">Cyl</th>
																							<th colspan="1">Axis</th>
																							<th colspan="1">V.A.</th>
																						</tr>
																						<tr>
																							<th colspan="2" rowspan="1">Dist.</th>
																							<td colspan="1" th:text="${visit.sphDistRight}"></td>
																							<td colspan="1" rowspan="1"
																								th:text="${visit.cylRight}"></td>
																							<td colspan="1" rowspan="1"
																								th:text="${visit.axisRight}"></td>
																							<td colspan="1" rowspan="1"
																								th:text="${visit.vaRight}"></td>
																							<td colspan="1" rowspan="1"
																								th:text="${visit.sphDistLeft}"></td>
																							<td colspan="1" rowspan="1"
																								th:text="${visit.cylLeft}"></td>
																							<td colspan="1" rowspan="1"
																								th:text="${visit.axisLeft}"></td>
																							<td colspan="1" rowspan="1"
																								th:text="${visit.vaLeft}"></td>
																						</tr>
																						<tr>
																							<th colspan="2" rowspan="1">Near</th>
																							<td colspan="1" th:text="${visit.sphNearRight}"></td>
																							<td colspan="1"></td>
																							<td colspan="1"></td>
																							<td colspan="1"></td>
																							<td colspan="1" th:text="${visit.sphNearLeft}"></td>
																							<td colspan="1"></td>
																							<td colspan="1"></td>
																							<td colspan="1"></td>
																						</tr>
																					</thead>
																				</table>
																			</div>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">Remarks :</p>
																			<div class="col-sm-6">
																				<textarea rows="2" class="form-control"
																					draggable="false" th:text="${visit.remarks}"
																					readonly="true"></textarea>
																			</div>
																		</div>
																	</div>
																	<!-- Glass Prescription Tab Ends -->


																	<!-- Findings Tab -->
																	<div th:id="'findings_' + ${visit.visitId}"
																		class="tab-pane fade">
																		<div class="form-group">
																			<p class="control-label col-sm-2">Anterior
																				Segment Finding :</p>
																			<div class="col-sm-3">
																				<textarea rows="4" draggable="false" readonly="true"
																					class="form-control" th:text="${visit.anteriorSeg}"></textarea>
																			</div>
																			<p class="control-label col-sm-2">Posterior
																				Segment Finding :</p>
																			<div class="col-sm-3">
																				<textarea rows="4" draggable="false" readonly="true"
																					class="form-control"
																					th:text="${visit.posteriorSeg}"></textarea>
																			</div>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">IOP :</p>
																			<div class="col-sm-2">
																				<p class="control-label textCenter"
																					th:text="${visit.iop}"></p>
																			</div>
																		</div>
																	</div>
																	<!-- Findings Tab Ends -->

																	<!-- Drug Tab -->
																	<div th:id="'drug_' + ${visit.visitId}"
																		class="tab-pane fade">
																		<div class="form-group">
																			<div class="table-responsive col-sm-12">
																				<table class="table table-striped" th:id="drugTable">
																					<thead>
																						<tr>
																							<th>Type</th>
																							<th>Name</th>
																							<th>Quantity</th>
																							<th>Frequency</th>
																							<th>Duration</th>
																						</tr>
																					</thead>
																					<tbody>
																						<tr th:each="drug : ${visit.drugs}"
																							class="clickable-row">
																							<td th:text="${drug.drugType}"></td>
																							<td th:text="${drug.drugName}"></td>
																							<td th:text="${drug.quantity}"></td>
																							<td th:text="${drug.frequency}"></td>
																							<td
																								th:text="${drug.duration} + ' ' + ${drug.durationType}"></td>
																						</tr>
																					</tbody>
																				</table>
																			</div>
																		</div>
																	</div>

																	<!-- Drug Tab Ends -->

																	<!-- A-Scan Tab -->
																	<div th:id="'ascan_' + ${visit.visitId}"
																		class="tab-pane fade">
																		<div class="form-group">
																			<label class="control-label col-sm-2">Keratometry</label>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">K1</p>
																			<div class="col-sm-3">
																				<p class="control-label textCenter"
																					th:text="${visit.keraK1}"></p>
																			</div>
																			<p class="control-label col-sm-2">K2</p>
																			<div class="col-sm-3">
																				<p class="control-label textCenter"
																					th:text="${visit.keraK2}"></p>
																			</div>
																		</div>
																		<div class="form-group">
																			<label class="control-label col-sm-2">Axis</label>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">Axial Length</p>
																			<div class="col-sm-3">
																				<p class="control-label textCenter"
																					th:text="${visit.axialLength}"></p>
																			</div>
																			<p class="control-label col-sm-2">IOL Power</p>
																			<div class="col-sm-3">
																				<p class="control-label textCenter"
																					th:text="${visit.iolPower}"></p>
																			</div>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">Surgical Plan</p>
																			<div class="col-sm-5">
																				<textarea rows="3" class="form-control"
																					readonly="true" draggable="false"
																					th:text="${visit.surgicalPlan}"></textarea>
																			</div>
																		</div>
																	</div>

																	<!-- A-Scan Tab Ends -->

																	<!-- Discharge Tab -->
																	<div th:id="'discharge_' + ${visit.visitId}"
																		class="tab-pane fade">
																		<div class="form-group">
																			<p class="control-label col-sm-2">Date of
																				Admission</p>
																			<div class="col-sm-3">
																				<p th:if="${visit.admissionDate != null}"
																					class="control-label textCenter"
																					th:text="${#dates.format(visit.admissionDate,'dd-MMM-yyyy')}"></p>
																			</div>
																			<p class="control-label col-sm-2">Date of Surgery</p>
																			<div class="col-sm-3">
																				<p th:if="${visit.surgeryDate != null}"
																					class="control-label textCenter"
																					th:text="${#dates.format(visit.surgeryDate,'dd-MMM-yyyy')}"></p>
																			</div>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">Date of
																				Discharge</p>
																			<div class="col-sm-3">
																				<p th:if="${visit.dischargeDate != null}"
																					class="control-label textCenter"
																					th:text="${#dates.format(visit.dischargeDate,'dd-MMM-yyyy')}"></p>
																			</div>
																			<p class="control-label col-sm-2">Diagnosis</p>
																			<div class="col-sm-3">
																				<textarea rows="3" draggable="false" readonly="true"
																					th:text="${visit.diagnosis}" class="form-control"></textarea>
																			</div>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">Surgical
																				Procedure</p>
																			<div class="col-sm-3">
																				<textarea rows="3" draggable="false" readonly="true"
																					th:text="${visit.surgicalProc}"
																					class="form-control"></textarea>
																			</div>
																			<p class="control-label col-sm-2">Investigations</p>
																			<div class="col-sm-3">
																				<textarea rows="3" draggable="false" readonly="true"
																					th:text="${visit.investigations}"
																					class="form-control"></textarea>
																			</div>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">Anaesthetist</p>
																			<div class="col-sm-3">
																				<p class="control-label textCenter"
																					th:text="${visit.anaesthetist}"></p>
																			</div>
																			<p class="control-label col-sm-2">Surgeon</p>
																			<div class="col-sm-3 textCenter">
																				<p class="control-label" th:text="${visit.surgeon}"></p>
																			</div>
																		</div>
																		<div class="form-group">
																			<p class="control-label col-sm-2">Follow Up</p>
																			<p class="control-label col-sm-2 textCenter"
																				th:text="${visit.followUp} + ' days'"
																				style="text-align: left"></p>
																			<p class="control-label col-sm-offset-1 col-sm-2">Fees</p>
																			<div class="col-sm-2 textCenter">
																				<p class="control-label" th:text="${visit.fees}"></p>
																			</div>
																		</div>
																	</div>

																	<!-- Discharge Tab Ends -->
																</div>
															</div>


															<div class="modal-footer">
																<button type="button" class="btn btn-default"
																	data-dismiss="modal">Close</button>
															</div>
														</div>
													</div>
												</div>
											</td>
											<td>
												<a type="button" class="btn btn-primary"
													th:href="@{'/dashboard/print/CaseReport_' + ${visit.visitId} + '.pdf'}"
													target="_blank" th:id="'printVisit_' + ${visit.visitId}" >
													<i class="glyphicon glyphicon-print"></i>
												</a>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		<!-- /#page-content-wrapper -->
	</div>
	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>

	<!-- Include all compiled plugins (below), or include individual files as needed -->
	<script type="text/javascript" th:src="@{/js/bootstrap.js}"></script>
	<script type="text/javascript" th:src="@{/js/bootstrap-datepicker.js}"></script>
	<script type="text/javascript" th:src="@{/js/main.js}"></script>
	<script type="text/javascript" th:src="@{/js/ajaxCalls.js}"></script>
	<script>
		$("#menu-toggle").click(function(e) {
			e.preventDefault();
			$("#wrapper").toggleClass("toggled");
		});
		$(document).ready(function() {
			if ($("#visitSearchDrop").val() != "date") {
				$("#dateFromDiv").hide();
				$("#dateToDiv").hide();
				$("#nameTextDiv").show();
			} else {
				$("#dateFromDiv").show();
				$("#dateToDiv").show();
				$("#nameTextDiv").hide();
			}

			$('#searchDateFrom').datepicker({
				format : "dd-M-yy"
			});
			$('#searchDateTo').datepicker({
				format : "dd-M-yy"
			});
		});
	</script>
</body>
</html>